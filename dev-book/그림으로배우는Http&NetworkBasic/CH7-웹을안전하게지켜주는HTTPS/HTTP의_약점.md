# 7.1 HTTP의 약점

- HTTP는 주로 다음과 같은 약점을 가진다.
    - 평문(암호화 하지 않은) 통신이기 때문에 도청 가능
    - 통신 상대를 확인하지 않기 때문에 위장 가능
    - 완전성을 증명할 수 없기 때문에 변조 가능
- 위와 같은 약점은 HTTP만이 아닌, 다른 암호화하지 않은 프로토콜에도 공통되는 문제이다.

<br>

## 📌 (1) 평문이기 때문에 도청 가능

- HTTP를 사용한 request나 response 통신 내용은 HTTP 자신을 암호화하는 기능은 없기 때문에 통신 전체가 암호화 되지는 않는다. 즉, 평문(암호화 되지 않은 메시지)으로 HTTP 메시지를 보내게 된다.

▶️ **TCP/IP는 도청 가능한 네트워크 (문제 상황)**

- TCP/IP의 구조의 통신 내용은 전부 통신 경로의 도중에 엿볼 수 있다.
- 이유
    - 인터넷은 전 세계를 공유하는 네트워크로 되어 있다. 통신 경로 상에 있는 네트워크 기기나 케이블이나 컴퓨터 등을 전부 자기 자신이 소유하고 있는 일은 없다. 따라서 악의를 가진 누군가가 엿볼 수 있다.
    - 암호화 통신 여부에 상관없이 통신 내용은 엿볼 수 있다. 암호화 통신은 메시지 속의 의미는 간파할 수 없는 것이다.
    - 네트워크 상을 흐르고 있는 패킷을 수집하는 것만으로 도청 가능하다. 패킷을 해석하는 패킷 캡처나 스니퍼라는 툴을 사용한다.

▶️ **암호화로 도청을 피하다 (해결 방법)**

- 도청으로부터 정보를 지키기 위한 방법 중 가장 보급되어 있는 기술이 암호화이다.
- 암호화에는 몇 가지의 대상이 있다.

1) 통신 암호화

- HTTP에는 암호화 구조는 없지만, SSL(Secure Socket Layer)이나 TLS(Transport Layer Security)이라는 다른 프로토콜을 조합함으로써 HTTP의 통신 내용을 암호화할 수 있다.
- SSL 등을 이용해 안전한 통신로를 확립하고 나서 그 통신로를 사용해 HTTP 통신을 한다.
- SSL을 조합한 HTTP를 HTTPS나 HTTP over SSL이라 부른다.

2) 콘텐츠 암호화

- 통신하고 있는 콘텐츠의 내용 자체를 암호화하는 방법이다.
- HTTP에 암호화를 하는 기능은 없기 때문에 HTTP를 사용해서 운반하는 내용을 암호화하는 것이다.
    - HTTP 메시지에 포함되는 콘텐츠만 암호화함 ⇒ 메시지 헤더는 X, 메시지 바디에 들어가는 콘텐츠를 암호화함
- 콘텐츠의 암호화를 유효하게 하기 위해서는 클라이언트와 서버가 콘텐츠의 암복호화 구조를 가지고 있어야 한다.
    - 평상시에 유저가 사용하는 브라우저와 웹 서버에서는 이용하는 것은 어려움
    - 주로 웹 서비스 등에서 이용되는 방법임

<br>

## 📌 (2) 통신 상대를 확인하지 않기 때문에 위장 가능

- HTTP를 사용한 요청과 응답에서는 통신 상대를 확인하지 않는다.

▶️ **누구나 요청할 수 있다 (문제 상황)**

- HTTP에 의한 통신에는 상대가 누구인지 확인하는 처리는 없기 때문에 누구든지 요청을 보낼 수 있다. (HTTP 통신만 생각했을 때)
- 요청이 오면 상대가 누구든지 무엇인간의 응답을 반환한다. (단, IP 주소나 포트 등에서 액세스 제한 설정이 없는 경우)
- 즉, HTTP는 누구이던 간에 요청을 보내면 응답을 반환하는 매우 심플한 구조로 되어 있지만, 상대를 확인하지 않는 점이 약점일 수 있다.
    - 요청을 받는 곳의 웹 서버가 올바른 웹 서버인지 위장한 웹 서버인지
    - 응답을 받는 곳의 클라이언트가 올바른 클라이언트인지 위장한 클라이언트인지
    - 통신하고 있는 상대가 접근이 허가된 상대인지 아닌지
    - 의미없는 요청이라도 수신하므로, 대량의 요청에 의한 DoS 공격 방지 불가

▶️ **상대를 확인하는 증명서 (해결 방법)**

- HTTP에서는 통신 상대를 확인할 수 없지만 SSL로 상대를 확인할 수 있다.
    - SSL은 암호화뿐만 아니라 상대를 확인하는 수단으로 증명서를 제공함
    - 증명서는 신뢰할 수 있는 제3자 기관에 의해 발행되는 것이기 때문에 서버나 클라이언트가 실재하는 사실을 증명함, 증명서를 위조하는 것은 기술적으로 상당히 어려움

  ⇒ 통신 상대인 서버나 클라이언트가 가진 증명서를 확인함으로써 통신 상대가 내가 통신하고자 하는 상대인지 판단 가능

<br>

## 📌 (3) **완전성을 증명할 수 없기 때문에 변조 가능**

- 완전성은 정보의 정확성을 가리킨다.
- 완전성을 증명할 수 없다는 것은 정보가 정확한지 아닌지 확인할 수 없음을 의미한다.

▶️ **수신한 내용이 다를지도 모른다 (문제 상황)**

- HTTP가 완전성을 증명할 수 없다는 뜻은 만약 요청이나 응답이 발신된 후에 상대가 수신할 때까지의 사이에 변조되었다고 하더라도 이 사실을 알 수 없다는 뜻이다.
    - 발신된 요청, 응답이 수신한 요청, 응답과 같은지 확인할 수 없음
- 이와 같이 공격자가 도중에 요청이나 응답을 빼앗아 변조하는 공격을 중간자 공격(Man-in-the-Middle 공격)이라고 부른다.

▶️ **변조를 방지하려면?**

- 자주 사용되고 있는 방법은 MD5나 SHA-1 등의 해시 값을 확인하는 방법과 파일의 디지털 서명을 확인하는 방법이다.
- 예시
    - 파일 다운로드 서비스를 제공하고 있는 웹 사이트에서는 PGP(Pretty Good Privacy)에 의한 서명과 MD5에 의한 해시 값을 제공함
    - PGP는 파일을 작성했다는 증명을 위한 서명이고, MD5는 단방향성 함수에 의한 해시 값임
    - 어느 쪽을 사용하더라도 브라우저에서 자동적으로 검사가 진행되는 것은 아니므로, 사용자가 직접 다운로드 받은 파일을 검사해야 함
- 하지만, 해당 방법들도 확실한 해결 방법은 아니다.
    - PGP와 MD5 자체도 적절하게 수정되어 있다고 한다면, 사용자로서는 알 수 없음
- 즉, 확실히 방지하기 위해서는 HTTPS를 사용해야 한다.
    - SSL에는 인증, 암호화, 다이제스트 기능을 제공함
    - HTTP만으로는 완전성을 보증하기 어렵기 때문에 다른 프로토콜을 조합하여 실현하고 있음

<br>

## 정리하자면,

위와 같은 3가지 문제점이 존재하므로, HTTPS 통신이 필요하다.